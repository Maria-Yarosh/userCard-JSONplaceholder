(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();class x{constructor(){this.state={users:null,posts:null,isLoading:!1,isLoadingUsers:!1,editingId:null,isAddPostLoading:!1,error:null,errorLoadingUsersList:null,errorLoadingUsersPosts:null,errorCreatingPost:null,errorDeletingPost:null},this.listeners=[]}getState(){return{...this.state}}setState(t){this.state={...this.state,...t},this.notify()}subscribe(t){this.listeners.includes(t)||this.listeners.push(t)}notify(){this.listeners.forEach(t=>t(this.state))}}const s=new x,y="https://jsonplaceholder.typicode.com",S={async fetchUsers(){return(await fetch(`${y}/users`)).json()},async fetchPosts(e){return(await fetch(`${y}/posts?userId=${e}`)).json()}},P={async fetchUsers(){console.log("actions call"),s.setState({...s.getState(),isLoadingUsers:!0});try{const e=await S.fetchUsers();console.log(e),s.setState({...s.getState(),users:e}),console.log(s.getState())}catch(e){s.setState({...s.getState(),errorLoadingUsersList:e})}finally{s.setState({...s.getState(),isLoadingUsers:!1})}},async fetchPosts(){s.setState({...s.getState(),isAddPisAddPostLoading:!0});try{const e=await S.fetchPosts();s.setState({...s.getState(),posts:e})}catch(e){s.setState({...s.getState(),errorLoadingUsersPosts:e})}finally{s.setState({...s.getState(),isAddPisAddPostLoading:!1})}}},C=({user:e})=>{const{email:t,phone:r,website:a,company:n,name:o,username:c,id:E}=e,{name:N}=n,i=document.createElement("div");i.className="user-card";const l=document.createElement("div");l.className="user-avatar",l.textContent=o[0];const d=document.createElement("h2");d.className="user-name",d.textContent=o;const u=document.createElement("p");u.className="user-username",u.textContent=`@${c}`;const m=document.createElement("div");return m.className="user-info",[{icon:"📧",text:t},{icon:"📱",text:r},{icon:"🌐",text:a},{icon:"🏢",text:N}].forEach(U=>{const{icon:b,text:v}=U,p=document.createElement("div");p.className="info-item";const f=document.createElement("span");f.className="info-icon",f.textContent=b;const h=document.createElement("p");h.textContent=v,p.append(f,h),m.append(p)}),i.append(l,d,u,m),i.addEventListener("click",()=>{navigate(`/posts/${E}`)}),i},w=()=>{console.log("UserPage call");const e=document.createElement("div");return e.className="users-container",P.fetchUsers(),s.subscribe(t=>{t.users&&(e.innerHTML="",console.log(t.user),t.users.forEach(r=>{e.append(C({user:r}))}))}),e},I=e=>{const t=document.createElement("div");t.className="post";const r=document.createElement("p"),a=document.createElement("p");return r.className="post-title",a.className="post-body",r.textContent=e.title,a.textContent=e.body,div.append(r,a),t},A=()=>{const e=document.createElement("div");return e.id="posts-container",P.fetchPosts(),s.subscribe(t=>{t.posts&&(usersListPage.innerHTML="",t.posts.forEach(r=>{e.append(I({post:r}))}))}),e},g=document.getElementById("app");function L(){const e=window.location.pathname;console.log("router call"),g.innerHTML="",e==="/"?(s.setState({...s.getState(),posts:null}),g.appendChild(w())):e.startsWith("/post/")&&(s.setState({...s.getState(),users:null}),e.split("/")[2],g.appendChild(A()))}window.onpopstate=L;L();
